<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>F4 SEJ Bab 4 Output Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f2f2f2;
            max-width: 1000px;
            margin: 0 auto;
        }
        .question {
            background: #fff;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .result {
            background: #e6ffe6;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
        }
        button:hover {
            background-color: #45a049;
        }
        .history {
            background: #e6f3ff;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .hidden {
            display: none;
        }
        .tabs {
            display: flex;
            margin-bottom: 20px;
        }
        .tab {
            padding: 10px 20px;
            background: #ddd;
            cursor: pointer;
            border-radius: 5px 5px 0 0;
            margin-right: 5px;
        }
        .tab.active {
            background: #4CAF50;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .correct {
            color: green;
        }
        .incorrect {
            color: red;
        }
        .save-buttons {
            margin-top: 20px;
            text-align: center;
        }
        .save-btn {
            background-color: #2196F3;
            margin: 5px;
        }
        .save-btn:hover {
            background-color: #0b7dda;
        }
        .header {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 30px;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .header h1 {
            margin: 0;
            font-size: 2.2rem;
        }
        .header p {
            margin: 10px 0 0 0;
            font-size: 1.1rem;
            opacity: 0.9;
        }
        input, select {
            width: 100%;
            padding: 8px;
            margin: 5px 0 10px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        label {
            font-weight: bold;
            color: #333;
        }
        .form-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .question-text {
            font-size: 1.1rem;
            line-height: 1.5;
            margin-bottom: 15px;
        }
        .option-label {
            display: block;
            padding: 8px;
            margin: 5px 0;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        .option-label:hover {
            background-color: #f0f0f0;
        }
        .option-label input {
            width: auto;
            margin-right: 8px;
        }
    </style>
</head>
<body>

<div class="header">
    <h1>ğŸ“š F4 SEJ Bab 4 Output Test</h1>
    <p>Era Peralihan Kuasa British di Negara Kita</p>
</div>

<div class="tabs">
    <div class="tab active" onclick="showTab('quiz')">åšæµ‹éªŒ</div>
    <div class="tab" onclick="showTab('history')">æŸ¥çœ‹è®°å½•</div>
</div>

<div id="quiz" class="tab-content active">
    <div class="form-section">
        <form id="quizForm">
            <label>å­¦ç”Ÿå§“å / Nama Pelajar:</label><br>
            <input type="text" id="name" required placeholder="è¯·è¾“å…¥æ‚¨çš„å§“å"><br>

            <label>å¹´çº§ / Tingkatan:</label><br>
            <select id="form" required>
                <option value="">é€‰æ‹©å¹´çº§</option>
                <option value="F1">F1 (Form 1)</option>
                <option value="F2">F2 (Form 2)</option>
                <option value="F3">F3 (Form 3)</option>
                <option value="F4">F4 (Form 4)</option>
                <option value="F5">F5 (Form 5)</option>
            </select><br>
        </form>
    </div>

    <div id="questions"></div>

    <div class="save-buttons">
        <button type="button" onclick="submitQuiz()">æäº¤æµ‹éªŒ ğŸ“</button>
        <button type="button" class="save-btn" onclick="saveProgress()">ä¿å­˜è¿›åº¦ ğŸ’¾</button>
        <button type="button" class="save-btn" onclick="loadProgress()">åŠ è½½è¿›åº¦ ğŸ“‚</button>
    </div>

    <div id="result" class="result hidden"></div>
</div>

<div id="history" class="tab-content">
    <h3>ğŸ“Š ä½ çš„æµ‹éªŒè®°å½•</h3>
    <div id="historyList"></div>
</div>

<script>
const questions = [
    {
        q: "British Military Administration (BMA) bermula di Tanah Melayu pada 12 September 1945. Apakah tugas BMA?<br><br>I. Memulihkan kepercayaan rakyat<br>II. Menjaga keharmonian penduduk<br>III. Memberikan kuasa kepada sultan<br>IV. Mengembalikan kestabilan dan keamanan",
        options: ["A. I dan II", "B. I dan IV", "C. II dan III", "D. III dan IV"],
        answer: "B. I dan IV",
        explain: "Tugas utama BMA adalah memulihkan kepercayaan rakyat selepas pemerintahan Jepun yang keras, dan mengembalikan kestabilan serta keamanan di Tanah Melayu. BMA perlu memastikan keadaan aman sebelum pentadbiran sivil dapat dipulihkan.",
        encourage: "ğŸŒŸ å¾ˆå¥½ï¼ä½ ç†è§£äº†BMAçš„ä¸»è¦èŒè´£ï¼è®°ä½BMAæ˜¯æˆ˜åæ¢å¤å·¥ä½œçš„é‡è¦é˜¶æ®µã€‚"
    },
    {
        q: "Apakah tujuan utama British menubuhkan BMA?",
        options: ["A. Menjajah Tanah Melayu secara kekal", "B. Mengembalikan kestabilan dan keamanan", "C. Mengeksploitasi sumber ekonomi", "D. Menghapuskan kuasa Raja-raja Melayu"],
        answer: "B. Mengembalikan kestabilan dan keamanan",
        explain: "Tujuan utama BMA adalah untuk mengembalikan kestabilan dan keamanan serta memulihkan kepercayaan rakyat selepas kekalahan Jepun. BMA perlu menangani masalah keganasan dan kekacauan yang berlaku.",
        encourage: "ğŸ¯ ä¼˜ç§€ï¼ä½ ç†è§£äº†BMAçš„ä¸»è¦ç›®æ ‡ï¼è¿™æ˜¯ç†è§£è‹±å›½æˆ˜åæ”¿ç­–çš„å…³é”®ã€‚"
    },
    {
        q: "Gagasan Malayan Union diperkenalkan untuk menggantikan?",
        options: ["A. British Military Administration (BMA)", "B. Persekutuan Tanah Melayu", "C. Negeri-negeri Selat", "D. Negeri-negeri Melayu Bersekutu"],
        answer: "A. British Military Administration (BMA)",
        explain: "Malayan Union diperkenalkan pada 1 April 1946 untuk menggantikan BMA. Ini adalah sistem pentadbiran baharu yang dirangka oleh Unit Perancang Tanah Melayu.",
        encourage: "ğŸŒˆ å¤ªæ£’äº†ï¼ä½ æŒæ¡äº†è¡Œæ”¿ä½“ç³»çš„å˜è¿ï¼è¿™ä¸ªæ—¶é—´é¡ºåºå¾ˆé‡è¦ã€‚"
    },
    {
        q: "Siapakah pegawai British yang dihantar untuk mendapatkan tandatangan Raja-raja Melayu bagi persetujuan Malayan Union?",
        options: ["A. Sir Edward Gent", "B. Sir Harold MacMichael", "C. H.C. Willan", "D. Ralph Hone"],
        answer: "B. Sir Harold MacMichael",
        explain: "Sir Harold MacMichael tiba di Tanah Melayu pada 11 Oktober 1945 dengan misi untuk mendapatkan tandatangan Raja-raja Melayu. Beliau menggunakan pelbagai taktik termasuk desakan dan ugutan.",
        encourage: "ğŸ’ª å‡ºè‰²ï¼ä½ è®°ä½äº†è¿™ä¸ªé‡è¦çš„å†å²äººç‰©ï¼MacMichaelçš„ä½¿å‘½æ˜¯äº‰è®®æ€§çš„å†å²äº‹ä»¶ã€‚"
    },
    {
        q: "Prinsip kewarganegaraan dalam Malayan Union berdasarkan?",
        options: ["A. Jus soli (berdasarkan tempat lahir)", "B. Jus sanguinis (berdasarkan keturunan)", "C. Naturalisasi sahaja", "D. Kebenaran Raja-raja Melayu"],
        answer: "A. Jus soli (berdasarkan tempat lahir)",
        explain: "Malayan Union menggunakan prinsip jus soli iaitu semua yang dilahirkan di Tanah Melayu dan Singapura diiktiraf sebagai warganegara. Ini menyebabkan ketidakpuasan hati orang Melayu kerana kewarganegaraan dianggap terlalu liberal.",
        encourage: "ğŸ”¥ æ°å‡ºï¼ä½ ç†è§£äº†è¿™ä¸ªäº‰è®®æ€§çš„å…¬æ°‘æƒåˆ¶åº¦ï¼è¿™æ­£æ˜¯å¼•èµ·é©¬æ¥äººå¼ºçƒˆåå¯¹çš„åŸå› ã€‚"
    },
    {
        q: "Mengapakah orang Melayu menentang Malayan Union?",
        options: ["A. Sistem cukai yang tinggi", "B. Status quo orang Melayu diancam", "C. Bahasa Melayu tidak diiktiraf", "D. Sistem pendidikan diabaikan"],
        answer: "B. Status quo orang Melayu diancam",
        explain: "Orang Melayu menentang kerana Malayan Union mengancam kedudukan istimewa mereka, mengurangkan kuasa Raja-raja Melayu, dan memberikan kewarganegaraan yang terlalu liberal kepada kaum imigran.",
        encourage: "ğŸ† ç²¾å½©ï¼ä½ å®Œå…¨ç†è§£äº†é©¬æ¥äººçš„æ‹…å¿§ï¼è¿™æ˜¯ç†è§£ç§æ—æ”¿æ²»çš„é‡è¦æ¦‚å¿µã€‚"
    },
    {
        q: "Satu persidangan Raja-raja Melayu diadakan di Kuala Kangsar, Perak bagi membincangkan isu berkaitan Malayan Union pada bulan April 1946. Apakah keputusan yang dicapai dalam persidangan tersebut?",
        options: ["A. Menghantar surat bantahan ke London", "B. Menarik balik tandatangan persetujuan", "C. Memulau upacara pelantikan Gabenor Malayan Union", "D. Mengemukakan bantahan melalui Mahkamah Tinggi di England"],
        answer: "C. Memulau upacara pelantikan Gabenor Malayan Union",
        explain: "Dalam persidangan di Istana Iskandariah, Kuala Kangsar pada April 1946, Raja-raja Melayu memutuskan untuk memulau (tidak menghadiri) upacara pelantikan Gabenor Malayan Union sebagai tanda bantahan terhadap Malayan Union.",
        encourage: "ğŸ–ï¸ æ£’æäº†ï¼ä½ çŸ¥é“é©¬æ¥ç»Ÿæ²»è€…çš„æŠµæŠ—ç­–ç•¥ï¼è¿™æ˜¯ä¸€ç§å·§å¦™çš„æ”¿æ²»æŠ—è®®æ–¹å¼ã€‚"
    },
    {
        q: "Orang Melayu menentang Malayan Union dengan menganggap Malayan Union sebagai \"Hari Kematian\". Bagaimanakah mereka menunjukkan penentangan tersebut?",
        options: ["A. Memakai songkok lilitan putih", "B. Meniupkan semangat jihad", "C. Memboikot kuasa Barat", "D. Mengangkat senjata"],
        answer: "A. Memakai songkok lilitan putih",
        explain: "Orang Melayu menunjukkan penentangan mereka terhadap Malayan Union dengan memakai songkok yang dililit dengan kain putih sebagai tanda berkabung. Mereka menganggap 1 April 1946 sebagai \"Hari Kematian\" bangsa Melayu.",
        encourage: "â­ ä¼˜ç§€ï¼ä½ äº†è§£é©¬æ¥äººè¡¨è¾¾æŠ—è®®çš„è±¡å¾æ€§æ–¹å¼ï¼è¿™ç§å’Œå¹³æŠ—è®®å¾ˆæœ‰è±¡å¾æ„ä¹‰ã€‚"
    },
    {
        q: "Siapakah yang menyerahkan Sarawak kepada British pada 1946?",
        options: ["A. James Brooke", "B. Charles Brooke", "C. Charles Vyner Brooke", "D. Anthony Brooke"],
        answer: "C. Charles Vyner Brooke",
        explain: "Charles Vyner Brooke menyerahkan Sarawak kepada British pada 1 Julai 1946. Penyerahan ini disebabkan masalah pewarisan takhta, masalah kewangan, dan desakan British.",
        encourage: "ğŸŒŸ å¾ˆå¥½ï¼ä½ çŸ¥é“æœ€åä¸€ä½ç»Ÿæ²»ç ‚æ‹‰è¶Šçš„ç™½äººæ‹‰æƒ¹ï¼Brookeç‹æœçš„ç»“æŸæ˜¯é‡è¦å†å²è½¬æŠ˜ç‚¹ã€‚"
    },
    {
        q: "Mengapakah penduduk Sarawak menentang penyerahan kepada British?",
        options: ["A. Bertentangan dengan Perlembagaan 1941", "B. Menolak sistem demokrasi", "C. Takut kehilangan tanah", "D. Tidak mahu berbahasa Inggeris"],
        answer: "A. Bertentangan dengan Perlembagaan 1941",
        explain: "Perlembagaan 1941 menjanjikan pemerintahan sendiri kepada rakyat Sarawak. Prinsip Kelapan menyatakan bahawa penduduk Sarawak akan dibimbing untuk mentadbir sendiri negeri mereka.",
        encourage: "ğŸ¯ å®Œç¾ï¼ä½ ç†è§£äº†é‡è¦çš„å®ªæ³•é—®é¢˜ï¼è¿™ä½“ç°äº†å¯¹è‡ªæ²»æ‰¿è¯ºçš„é‡è§†ã€‚"
    },
    {
        q: "Mengapakah Vyner Brooke menyerahkan Sarawak kepada British?<br><br>I. Masalah kewangan<br>II. Masalah pewarisan takhta<br>III. Mengabaikan surat wasiat<br>IV. Mematuhi Perlembagaan 1941",
        options: ["A. I dan II", "B. I dan IV", "C. II dan III", "D. III dan IV"],
        answer: "A. I dan II",
        explain: "Vyner Brooke menyerahkan Sarawak kepada British kerana menghadapi masalah kewangan yang serius untuk membangunkan Sarawak selepas Perang Dunia Kedua, dan juga masalah pewarisan takhta kerana beliau tidak mempunyai anak lelaki untuk mewarisi takhta.",
        encourage: "ğŸ’ª å¤ªæ£’äº†ï¼ä½ ç†è§£äº†å¯¼è‡´ç ‚æ‹‰è¶Šç§»äº¤çš„å¤æ‚å› ç´ ï¼ç»æµå’Œæ”¿æ²»å› ç´ éƒ½å¾ˆé‡è¦ã€‚"
    },
    {
        q: "Mengapakah Rukun 13 ditubuhkan?",
        options: ["A. Menyokong penyerahan Sarawak", "B. Mempertahankan hak penduduk", "C. Memelihara kesucian agama Islam", "D. Menghapuskan pegawai tinggi British"],
        answer: "D. Menghapuskan pegawai tinggi British",
        explain: "Rukun 13 ditubuhkan secara rahsia di Sibu pada 20 Ogos 1948 dengan tujuan utama untuk menghapuskan pegawai tinggi British di Sarawak sebagai bentuk penentangan terhadap penyerahan Sarawak kepada British.",
        encourage: "ğŸ† å‡ºè‰²ï¼ä½ äº†è§£è¿™ä¸ªç§˜å¯†ç»„ç»‡çš„çœŸæ­£ç›®çš„ï¼è¿™æ˜¯æ¿€è¿›æŠµæŠ—è¿åŠ¨çš„ä¾‹å­ã€‚"
    },
    {
        q: "Mengapakah Young Malay Association (YMA) ditubuhkan di Sarawak?",
        options: ["A. Memajukan penduduk tempatan", "B. Melaksanakan pemerintahan sendiri", "C. Menggalakkan ahli bertukar pendapat", "D. Membangkitkan kesedaran nasionalisme"],
        answer: "B. Melaksanakan pemerintahan sendiri",
        explain: "Young Malay Association (YMA) ditubuhkan di Sarawak dengan tujuan utama untuk melaksanakan pemerintahan sendiri bagi rakyat Sarawak, selaras dengan janji dalam Perlembagaan 1941 yang menjanjikan self-government kepada penduduk Sarawak.",
        encourage: "ğŸŒˆ æ°å‡ºï¼ä½ ç†è§£äº†YMAäº‰å–è‡ªæ²»çš„ç›®æ ‡ï¼è¿™ä½“ç°äº†é’å¹´è¿åŠ¨çš„æ”¿æ²»è§‰é†’ã€‚"
    },
    {
        q: "Mengapakah penyerahan Sabah tidak mendapat bantahan hebat daripada penduduk tempatan?",
        options: ["A. Gerakan nasionalisme ditindas", "B. Penduduk menyokong British", "C. Tidak ada masalah ekonomi", "D. Raja-raja menyokong penyerahan"],
        answer: "A. Gerakan nasionalisme ditindas",
        explain: "British menindas kegiatan berpersatuan di Sabah dengan menawarkan jawatan dan memindahkan pemimpin aktif. Penduduk Sabah juga terdiri daripada pelbagai etnik yang sukar dihimpunkan.",
        encourage: "â­ å¾ˆå¥½ï¼ä½ ç†è§£äº†è‹±å›½æ§åˆ¶æŠµæŠ—çš„ç­–ç•¥ï¼åˆ†åŒ–ç»Ÿæ²»æ˜¯æ®–æ°‘æ”¿ç­–çš„å¸¸ç”¨æ‰‹æ®µã€‚"
    },
    {
        q: "Persatuan yang ditubuhkan untuk membangkitkan kesedaran politik di Sabah ialah?",
        options: ["A. Persaudaraan Sahabat Pena Sabah (PASPAS)", "B. Persatuan Melayu Sabah", "C. Rukun Sabah", "D. Parti Sabah"],
        answer: "A. Persaudaraan Sahabat Pena Sabah (PASPAS)",
        explain: "PASPAS adalah antara persatuan yang bergerak aktif dalam membangkitkan kesedaran politik di Sabah. Terdapat juga Persatuan Kebangsaan Melayu dan Barisan Pemuda Sabah (BARIP).",
        encourage: "ğŸ”¥ ä¼˜ç§€ï¼ä½ çŸ¥é“æ²™å·´æ”¿æ²»å²ä¸Šçš„é‡è¦ç»„ç»‡ï¼è¿™äº›ç»„ç»‡æ˜¯æ”¿æ²»è§‰é†’çš„å…ˆé©±ã€‚"
    },
    {
        q: "Akhbar yang menyuarakan bantahan terhadap Malayan Union ialah?",
        options: ["A. The Straits Times", "B. Utusan Melayu", "C. The Malay Mail", "D. Nanyang Siang Pau"],
        answer: "B. Utusan Melayu",
        explain: "Utusan Melayu, Majlis, dan Warta Negara adalah akhbar-akhbar Melayu yang giat menyuarakan bantahan terhadap Malayan Union. Akhbar ini memainkan peranan penting dalam menggerakkan orang Melayu.",
        encourage: "ğŸ“° å¤ªæ£’äº†ï¼ä½ äº†è§£åª’ä½“åœ¨ç‹¬ç«‹æ–—äº‰ä¸­çš„ä½œç”¨ï¼æŠ¥çº¸æ˜¯å½“æ—¶é‡è¦çš„å®£ä¼ å·¥å…·ã€‚"
    },
    {
        q: "Tokoh wanita yang terlibat dalam menentang Malayan Union ialah?",
        options: ["A. Tun Fatimah", "B. Cikgu Zaharah Abdullah", "C. Che Siti Wan Kembang", "D. Toh Puan Rahah"],
        answer: "B. Cikgu Zaharah Abdullah",
        explain: "Cikgu Zaharah Abdullah adalah antara tokoh wanita yang terlibat dalam menentang Malayan Union. Beliau bersama tokoh wanita lain seperti Halimahton Abd Majid dan Saleha Mohd Ali menggembleng tenaga untuk mendapat kembali hak-hak Melayu.",
        encourage: "ğŸŒ¸ å¾ˆå¥½ï¼ä½ è®°ä½äº†å¥³æ€§åœ¨æ°‘æ—æ–—äº‰ä¸­çš„è´¡çŒ®ï¼å¥³æ€§ä¹Ÿæ˜¯æŠµæŠ—è¿åŠ¨çš„é‡è¦åŠ›é‡ã€‚"
    },
    {
        q: "Apakah faktor penyerahan Sabah kepada British?",
        options: ["A. Kelemahan pemerintah", "B. Permintaan penduduk", "C. Desakan pelabur", "D. Masalah kewangan"],
        answer: "D. Masalah kewangan",
        explain: "Faktor utama penyerahan Sabah kepada British adalah masalah kewangan yang dihadapi oleh Syarikat Borneo Utara British (SBUB). Selepas Perang Dunia Kedua, SBUB tidak mampu menanggung kos yang besar untuk membangunkan semula Sabah yang musnah akibat perang.",
        encourage: "ğŸ‘‘ æ°å‡ºï¼ä½ ç†è§£äº†ç»æµå› ç´ åœ¨æ”¿æ²»å†³ç­–ä¸­çš„é‡è¦æ€§ï¼æˆ˜åé‡å»ºéœ€è¦å·¨å¤§èµ„é‡‘ã€‚"
    },
    {
        q: "Orang Melayu menganggap hari pelaksanaan Malayan Union sebagai?",
        options: ["A. Hari Kegembiraan", "B. Hari Kematian", "C. Hari Kemerdekaan", "D. Hari Kebangsaan"],
        answer: "B. Hari Kematian",
        explain: "Orang Melayu menganggap 1 April 1946 (hari pelaksanaan Malayan Union) sebagai \"Hari Kematian\". Mereka memakai lilitan kain putih di songkok sebagai tanda berkabung dan penentangan.",
        encourage: "ğŸ’” æ­£ç¡®ï¼ä½ ç†è§£äº†é©¬æ¥äººå½“æ—¶çš„æ‚²æ„¤å¿ƒæƒ…ï¼è¿™ä½“ç°äº†ä»–ä»¬å¯¹æ°‘æ—å°Šä¸¥çš„çè§†ã€‚"
    },
    {
        q: "Apakah kesan utama penentangan terhadap Malayan Union?",
        options: ["A. British meninggalkan Tanah Melayu", "B. Penubuhan Persekutuan Tanah Melayu 1948", "C. Kemerdekaan segera diberikan", "D. Raja-raja Melayu dihapuskan"],
        answer: "B. Penubuhan Persekutuan Tanah Melayu 1948",
        explain: "Penentangan yang gigih terhadap Malayan Union memaksa British memansuhkannya dan menggantikan dengan Persekutuan Tanah Melayu 1948 yang lebih diterima oleh orang Melayu kerana mengekalkan kedudukan Raja-raja Melayu dan hak istimewa Melayu.",
        encourage: "ğŸ† å®Œç¾ï¼ä½ ç†è§£äº†é©¬æ¥äººæ–—äº‰çš„ä¼Ÿå¤§èƒœåˆ©ï¼è¿™è¯æ˜äº†äººæ°‘å›¢ç»“çš„åŠ›é‡ï¼"
    }
];

function showTab(tabId) {
    // Hide all tab contents
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // Deactivate all tabs
    document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // Show selected tab content
    document.getElementById(tabId).classList.add('active');
    
    // Activate selected tab
    event.currentTarget.classList.add('active');
    
    // If history tab is selected, load history
    if (tabId === 'history') {
        loadHistory();
    }
}

function submitQuiz() {
    const name = document.getElementById('name').value;
    const form = document.getElementById('form').value;
    
    if (!name || !form) {
        alert("è¯·å¡«å†™å®Œæ•´çš„ä¸ªäººä¿¡æ¯ï¼");
        return;
    }
    
    let score = 0;
    let results = [];
    let unanswered = 0;
    
    questions.forEach((q, index) => {
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        const isCorrect = selected && selected.value === q.answer;
        
        if (isCorrect) score++;
        if (!selected) unanswered++;
        
        results.push({
            question: q.q,
            selected: selected ? selected.value : "æœªä½œç­”",
            correct: q.answer,
            isCorrect: isCorrect,
            explain: q.explain,
            encourage: q.encourage
        });
    });
    
    // Save the attempt to history
    saveAttempt(name, form, score, results);
    
    // Display results
    displayResults(name, form, score, results, unanswered);
}

function displayResults(name, form, score, results, unanswered) {
    let output = `
        <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 20px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
            <h2 style="text-align: center; color: #2c3e50; margin-bottom: 20px;">ğŸ“Š æµ‹éªŒç»“æœ</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <div>
                    <p><strong>å­¦ç”Ÿå§“å:</strong> ${name}</p>
                    <p><strong>å¹´çº§:</strong> ${form}</p>
                    <p><strong>æµ‹éªŒ:</strong> F4 SEJ Bab 4 Output Test</p>
                </div>
                <div>
                    <p><strong>å¾—åˆ†:</strong> <span class="${score >= 15 ? 'correct' : 'incorrect'}" style="font-size: 1.3rem; font-weight: bold;">${score} / 20 (${Math.round(score/20*100)}%)</span></p>
                </div>
            </div>
            ${unanswered > 0 ? `<p style="color: orange; font-weight: bold;">âš ï¸ æ³¨æ„ï¼šä½ æœ‰ ${unanswered} é¢˜æ²¡æœ‰ä½œç­”</p>` : ''}
            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
                <p style="font-size: 1.1rem; color: #2c3e50; margin: 0;">${getFeedback(score)}</p>
            </div>
        </div>
        <hr style="margin: 30px 0;">
        <h3 style="color: #2c3e50; margin-bottom: 20px;">ğŸ“ è¯¦ç»†è§£ç­”</h3>
    `;
    
    results.forEach((r, index) => {
        output += `
            <div class="question" style="border-left: 5px solid ${r.isCorrect ? '#28a745' : '#dc3545'};">
                <p><strong>ç¬¬${index + 1}é¢˜ï¼š${r.isCorrect ? 'âœ… æ­£ç¡®' : 'âŒ é”™è¯¯'}</strong></p>
                <div class="question-text">${r.question}</div>
                ${!r.isCorrect ? `<p><strong>ä½ çš„ç­”æ¡ˆ:</strong> <span class="incorrect">${r.selected}</span></p>` : ''}
                <p><strong>æ­£ç¡®ç­”æ¡ˆ:</strong> <span class="correct">${r.correct}</span></p>
                <p><strong>ğŸ“– è§£é‡Š:</strong> ${r.explain}</p>
                <p><strong>ğŸ’ª é¼“åŠ±:</strong> ${r.encourage}</p>
            </div>
        `;
    });
    
    document.getElementById('result').innerHTML = output;
    document.getElementById('result').classList.remove('hidden');
    
    // Scroll to results
    document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
}

function saveAttempt(name, form, score, results) {
    const attempts = JSON.parse(localStorage.getItem('f4sejbab4QuizAttempts') || '[]');
    const attempt = {
        date: new Date().toLocaleString(),
        name,
        form,
        score,
        results
    };
    
    attempts.unshift(attempt); // Add new attempt at beginning
    localStorage.setItem('f4sejbab4QuizAttempts', JSON.stringify(attempts));
}

function getFeedback(score) {
    if (score === 20) {
        return "ğŸ‰ å¤ªå‰å®³å•¦ï¼å…¨å¯¹ï¼ä½ å¯¹F4 SEJ Bab 4çš„æŒæ¡å ªç§°å®Œç¾ï¼Œå†å²å­¦éœ¸å°±æ˜¯ä½ ï¼";
    } else if (score >= 17) {
        return "â­ æˆç»©å¾ˆä¸é”™ï¼ä½ å¯¹è‹±å›½æƒåŠ›è½¬ç§»æ—¶æœŸçš„ç†è§£å¾ˆæ·±åˆ»ï¼Œåªæœ‰å‡ ä¸ªå°ç»†èŠ‚éœ€è¦æ³¨æ„ï¼";
    } else if (score >= 14) {
        return "ğŸ‘ æŒºå¥½çš„ï¼åŸºæœ¬æ¦‚å¿µéƒ½æŒæ¡äº†ï¼Œçœ‹çœ‹é”™é¢˜è§£é‡Šï¼Œå·©å›ºä¸€ä¸‹çŸ¥è¯†ç‚¹ï¼";
    } else if (score >= 10) {
        return "ğŸ’ª æœ‰è¿›æ­¥ç©ºé—´ï¼å»ºè®®å¤šå¤ä¹ è¯¾æœ¬å†…å®¹ï¼Œç‰¹åˆ«å…³æ³¨é‡è¦äº‹ä»¶å’Œäººç‰©ï¼";
    } else {
        return "ğŸ“š éœ€è¦åŠ æ²¹ï¼å»ºè®®é‡æ–°é˜…è¯»è¯¾æœ¬ï¼Œç†è§£åŸºæœ¬æ¦‚å¿µï¼Œä¸è¦æ°”é¦ï¼Œå†å²éœ€è¦æ…¢æ…¢ç§¯ç´¯ï¼";
    }
}

function loadHistory() {
    const attempts = JSON.parse(localStorage.getItem('f4sejbab4QuizAttempts') || '[]');
    const historyList = document.getElementById('historyList');
    
    if (attempts.length === 0) {
        historyList.innerHTML = "<p>ä½ è¿˜æ²¡æœ‰ä»»ä½•æµ‹éªŒè®°å½•ï¼Œå¿«å»åšæµ‹éªŒå§ï¼</p>";
        return;
    }
    
    let html = "";
    attempts.forEach((attempt, index) => {
        html += `
            <div class="question" style="margin-bottom: 20px; padding: 20px; background: white; border-radius: 8px; border-left: 5px solid #4CAF50;">
                <h3>ğŸ“Š æµ‹éªŒè®°å½• #${index + 1} - ${attempt.date}</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 15px 0;">
                    <div>
                        <p><strong>å§“å:</strong> ${attempt.name}</p>
                        <p><strong>å¹´çº§:</strong> ${attempt.form}</p>
                    </div>
                    <div>
                        <p><strong>å¾—åˆ†:</strong> <span style="font-weight: bold; color: ${attempt.score >= 15 ? '#28a745' : '#dc3545'};">${attempt.score} / 20 (${Math.round(attempt.score/20*100)}%)</span></p>
                        <p><strong>æµ‹éªŒ:</strong> F4 SEJ Bab 4 Output Test</p>
                    </div>
                </div>
                <button onclick="viewAttemptDetails(${index})" style="background: #17a2b8;">æŸ¥çœ‹è¯¦ç»†ç­”æ¡ˆ ğŸ“–</button>
                <div id="attemptDetails${index}" style="display: none; margin-top: 20px;">
                    ${attempt.results.map((r, qIndex) => `
                        <div style="margin-bottom: 15px; padding: 15px; background: ${r.isCorrect ? '#e6ffe6' : '#ffe6e6'}; border-radius: 8px; border-left: 4px solid ${r.isCorrect ? '#28a745' : '#dc3545'};">
                            <p><strong>ç¬¬${qIndex + 1}é¢˜ï¼š${r.isCorrect ? 'âœ… æ­£ç¡®' : 'âŒ é”™è¯¯'}</strong></p>
                            <div style="margin: 10px 0; font-size: 0.95rem;">${r.question}</div>
                            ${!r.isCorrect ? `<p><strong>ä½ çš„ç­”æ¡ˆ:</strong> <span style="color: #dc3545;">${r.selected}</span></p>` : ''}
                            <p><strong>æ­£ç¡®ç­”æ¡ˆ:</strong> <span style="color: #28a745; font-weight: bold;">${r.correct}</span></p>
                            <p><strong>è§£é‡Š:</strong> ${r.explain}</p>
                            <p><strong>é¼“åŠ±:</strong> ${r.encourage}</p>
                        </div>
                    `).join('')}
                </div>
            </div>
        `;
    });
    
    historyList.innerHTML = html;
}

function viewAttemptDetails(index) {
    const detailsDiv = document.getElementById(`attemptDetails${index}`);
    if (detailsDiv.style.display === 'none') {
        detailsDiv.style.display = 'block';
    } else {
        detailsDiv.style.display = 'none';
    }
}

function saveProgress() {
    const name = document.getElementById('name').value;
    const form = document.getElementById('form').value;
    
    if (!name || !form) {
        alert("è¯·å…ˆå¡«å†™ä¸ªäººä¿¡æ¯ï¼");
        return;
    }
    
    const progress = {
        name,
        form,
        answers: []
    };
    
    questions.forEach((q, index) => {
        const selected = document.querySelector(`input[name="q${index}"]:checked`);
        progress.answers.push(selected ? selected.value : null);
    });
    
    localStorage.setItem('f4sejbab4QuizProgress', JSON.stringify(progress));
    alert("âœ… è¿›åº¦å·²ä¿å­˜ï¼ä½ å¯ä»¥ç¨åå›æ¥ç»§ç»­å®Œæˆæµ‹éªŒã€‚");
}

function loadProgress() {
    const progress = JSON.parse(localStorage.getItem('f4sejbab4QuizProgress'));
    
    if (!progress) {
        alert("âŒ æ²¡æœ‰æ‰¾åˆ°ä¿å­˜çš„è¿›åº¦ï¼");
        return;
    }
    
    document.getElementById('name').value = progress.name;
    document.getElementById('form').value = progress.form;
    
    progress.answers.forEach((answer, index) => {
        if (answer) {
            const radio = document.querySelector(`input[name="q${index}"][value="${answer}"]`);
            if (radio) radio.checked = true;
        }
    });
    
    alert("âœ… è¿›åº¦å·²åŠ è½½ï¼ä½ å¯ä»¥ç»§ç»­å®Œæˆæµ‹éªŒã€‚");
}

window.onload = function() {
    const qDiv = document.getElementById('questions');
    questions.forEach((q, index) => {
        const div = document.createElement('div');
        div.className = "question";
        div.innerHTML = `
            <div class="question-text"><strong>é¢˜ç›® ${index + 1}.</strong> ${q.q}</div>
            <div style="margin-top: 10px;">
                ${q.options.map(opt => `
                    <label class="option-label">
                        <input type="radio" name="q${index}" value="${opt}"> ${opt}
                    </label>
                `).join('')}
            </div>
        `;
        qDiv.appendChild(div);
    });
    
    // Check if there's saved progress
    if (localStorage.getItem('f4sejbab4QuizProgress')) {
        if (confirm("ğŸ” æ£€æµ‹åˆ°æœ‰ä¿å­˜çš„è¿›åº¦ï¼Œæ˜¯å¦åŠ è½½ï¼Ÿ")) {
            loadProgress();
        }
    }
}
</script>

</body>
</html>